<div class="container" style="padding:20px;">
  <h2>Generador de tabla de actividades</h2>

  <!-- Input Proyecto -->
  <div style="margin-bottom: 15px;">
    <label>Proyecto:</label>
    <input type="text" [(ngModel)]="proyecto" placeholder="Nombre del proyecto" />
  </div>

  <!-- Textarea para texto crudo -->
  <div style="margin-bottom: 15px;">
    <label>Texto de actividades:</label><br />
    <textarea [(ngModel)]="texto" rows="12" cols="100" placeholder="Pega aquÃ­ el texto..."></textarea>
  </div>

  <button (click)="procesarTexto()">Procesar</button>
  <button (click)="exportarExcel()" [disabled]="registrosFiltrados.length === 0">Exportar a Excel</button>

  <!-- Filtros de fecha -->
  <div style="margin: 20px 0;">
    <label>Fecha inicio:
      <input type="date" [(ngModel)]="fechaInicio" (change)="filtrarPorFechas()" />
    </label>
    <label style="margin-left:20px;">Fecha fin:
      <input type="date" [(ngModel)]="fechaFin" (change)="filtrarPorFechas()" />
    </label>
  </div>

  <!-- Tabla de actividades -->
  <div *ngIf="registrosFiltrados.length > 0" style="margin-top:20px;">
    <h3>Actividades</h3>
    <table border="1" cellspacing="0" cellpadding="5">
      <thead>
      <tr>
        <th>#</th>
        <th>Nombre</th>
        <th>Fecha</th>
        <th>Proyecto</th>
        <th>Actividad</th>
        <th>Total Horas</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let r of registrosFiltrados; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ r.nombre }}</td>
        <td>{{ r.fecha }}</td>
        <td>{{ r.proyecto }}</td>
        <td>{{ r.actividad }}</td>
        <td>{{ r.totalHoras }}</td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Tabla resumen por persona -->
  <div *ngIf="resumen.length > 0" style="margin-top:40px;">
    <h3>Resumen por persona</h3>
    <table border="1" cellspacing="0" cellpadding="5">
      <thead>
      <tr>
        <th>Nombre</th>
        <th>Horas Laborales</th>
        <th>Horas Registradas</th>
        <th>Horas sin Actividades</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let p of resumen">
        <td>{{ p.nombre }}</td>
        <td>
          <input type="number" [(ngModel)]="p.horasLaborales" (input)="recalcularResumen()" />
        </td>
        <td>{{ p.horasRegistradas.toFixed(2) }}</td>
        <td>{{ p.horasSinActividades.toFixed(2) }}</td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
